<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>一般醫學內科核心能力導向訓練指南</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts: Noto Sans TC -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
        }
        
        /* Custom Animations */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .animate-fade-in-up {
            animation: fadeInUp 0.5s ease-out forwards;
        }
        .animate-fade-in {
            animation: fadeIn 0.3s ease-out forwards;
        }
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        html {
            scroll-behavior: smooth;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Icons (Implemented as SVG components to avoid dependencies) ---
        const Icon = ({ path, className, size = 24, ...props }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width={size} 
                height={size} 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className} 
                {...props}
            >
                {path}
            </svg>
        );

        const Icons = {
            BookOpen: (props) => <Icon path={<><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></>} {...props} />,
            Activity: (props) => <Icon path={<polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/>} {...props} />,
            Users: (props) => <Icon path={<><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></>} {...props} />,
            Award: (props) => <Icon path={<><circle cx="12" cy="8" r="6"/><path d="M15.477 12.89 17 22l-5-3-5 3 1.523-9.11"/></>} {...props} />,
            ClipboardCheck: (props) => <Icon path={<><rect width="8" height="4" x="8" y="2" rx="1" ry="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><path d="m9 14 2 2 4-4"/></>} {...props} />,
            Layout: (props) => <Icon path={<><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><line x1="3" x2="21" y1="9" y2="9"/><line x1="9" x2="9" y1="9" y2="21"/></>} {...props} />,
            Stethoscope: (props) => <Icon path={<><path d="M4.8 2.3A.3.3 0 1 0 5 2H4a2 2 0 0 0-2 2v5a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6V4a2 2 0 0 0-2-2h-1a.2.2 0 1 0 .3.3"/><path d="M8 15v1a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6v-4"/><circle cx="20" cy="10" r="2"/></>} {...props} />,
            MessageCircle: (props) => <Icon path={<path d="m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z"/>} {...props} />,
            Brain: (props) => <Icon path={<><path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z"/><path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z"/></>} {...props} />,
            TrendingUp: (props) => <Icon path={<polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/>} {...props} />,
            Shield: (props) => <Icon path={<path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/>} {...props} />,
            Globe: (props) => <Icon path={<><circle cx="12" cy="12" r="10"/><line x1="2" x2="22" y1="12" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></>} {...props} />,
            ChevronRight: (props) => <Icon path={<path d="m9 18 6-6-6-6"/>} {...props} />,
            CheckCircle: (props) => <Icon path={<><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></>} {...props} />,
            FileText: (props) => <Icon path={<><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><line x1="10" x2="8" y1="9" y2="9"/></>} {...props} />,
            GraduationCap: (props) => <Icon path={<><path d="M22 10v6M2 10l10-5 10 5-10 5z"/><path d="M6 12v5c3 3 9 3 12 0v-5"/></>} {...props} />,
            Menu: (props) => <Icon path={<><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></>} {...props} />,
            X: (props) => <Icon path={<><path d="M18 6 6 18"/><path d="m6 6 12 12"/></>} {...props} />,
            Info: (props) => <Icon path={<><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></>} {...props} />,
            Target: (props) => <Icon path={<><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></>} {...props} />,
            List: (props) => <Icon path={<><line x1="8" x2="21" y1="6" y2="6"/><line x1="8" x2="21" y1="12" y2="12"/><line x1="8" x2="21" y1="18" y2="18"/><line x1="3" x2="3.01" y1="6" y2="6"/><line x1="3" x2="3.01" y1="12" y2="12"/><line x1="3" x2="3.01" y1="18" y2="18"/></>} {...props} />,
        };

        // --- Data Definitions ---

        const competencies = [
            {
                id: 'patient-care',
                title: '病人照護 (Patient Care)',
                icon: <Icons.Stethoscope className="w-8 h-8 text-blue-500" />,
                desc: '提供關懷、合宜及有效之照護。',
                what: '照顧病人的秘訣就在關懷病人。須能呈現富有愛心、關懷和同理心，適切且有效率地處理病患健康問題。',
                methods: ['從做中學 (Clinical Practice)', '病歷寫作 (POMR/SOAP)', '主治醫師巡診討論', '全人醫療觀念應用'],
                assessments: ['OSCE', 'Mini-CEX', 'CbD (Case-based Discussion)', '360度評量']
            },
            {
                id: 'medical-knowledge',
                title: '醫學知識 (Medical Knowledge)',
                icon: <Icons.Brain className="w-8 h-8 text-purple-500" />,
                desc: '運用生醫、臨床及社會行為科學知識於病患照顧。',
                what: '能以探討和分析的臨床方法，運用於臨床決策。知道並應用當前的基礎及臨床最新醫學知識。',
                methods: ['基本課程 (倫理、感控、品質)', '核心課程 (常見內科疾病)', '晨會/病例討論會', '教學迴診'],
                assessments: ['筆試', 'Mini-CEX', 'OSCE', 'CbD']
            },
            {
                id: 'pbl',
                title: '從工作中學習 (PBL&I)',
                icon: <Icons.TrendingUp className="w-8 h-8 text-green-500" />,
                desc: '自我評估、從錯誤中學習、實證醫學應用。',
                what: '研究和評估自己的病患照護，搜尋和整合醫學實證以改善臨床照護。使用電腦資訊科技維持繼續教育。',
                methods: ['晨會/床邊教學', 'M&M 討論會 (Mortality & Morbidity)', '實證醫學期刊討論會', 'Healthcare Matrix workshop'],
                assessments: ['OSCE', 'Mini-CEX', 'CbD', '期刊報告']
            },
            {
                id: 'communication',
                title: '溝通技巧 (Interpersonal Skills)',
                icon: <Icons.MessageCircle className="w-8 h-8 text-yellow-500" />,
                desc: '與病患、家屬及醫療團隊有效互動。',
                what: '運用凝神注視、傾聽、筆談等方式。建立良善醫病關係。提供專業會診並尊重互動。',
                methods: ['醫病溝通工作坊', '臨床實務討論', '同理心訓練 (同理性回應、回應情緒)'],
                assessments: ['OSCE', 'Mini-CEX', 'CbD', '360度評量']
            },
            {
                id: 'professionalism',
                title: '專業素養 (Professionalism)',
                icon: <Icons.Shield className="w-8 h-8 text-red-500" />,
                desc: '展現負責行為、醫學倫理、尊重多樣性。',
                what: '尊重、憐憫、正直。堅持守密及知情同意。符合社會期待的高道德標準。遵守醫學倫理四大原則 (行善、自主、不傷害、正義)。',
                methods: ['醫學倫理課程', '倫理病例討論會', '出院準備討論會', 'M&M 討論會'],
                assessments: ['OSCE', 'Mini-CEX', 'CbD', '360度評量']
            },
            {
                id: 'system-based',
                title: '制度下臨床工作 (SBP)',
                icon: <Icons.Globe className="w-8 h-8 text-cyan-500" />,
                desc: '瞭解醫療體系運作，有效運用資源。',
                what: '運用體系資源提供最佳照護。瞭解轉診體制與成本觀念。與團隊合作解決非疾病困難，如協調行政階層。',
                methods: ['聯合討論會 (跨團隊)', '出院準備會議', '病房交班', '合併症病例討論'],
                assessments: ['OSCE', 'Mini-CEX', 'CbD', '交班評估']
            }
        ];

        const requirements = [
            {
                level: 'PGY1',
                core: ['胸痛', '腹痛', '呼吸困難', '意識障礙'],
                basic: ['感染症及抗生素使用', '高血壓', '糖尿病'],
                imaging: ['EKG', 'CXR'],
                video_req: '需完成 4 項核心能力影音課程',
                note: '需於內科訓練期間內完成所有基本疾病、所有影像教學及核心能力課程。'
            },
            {
                level: 'PGY2 (不分組)',
                core: ['胸痛', '腹痛', '呼吸困難', '意識障礙', '發燒', '頭痛'],
                basic: ['感染症', '高血壓', '糖尿病', '貧血', '背痛', '關節痛', '寡尿'],
                imaging: ['EKG', 'CXR'],
                video_req: '需完成 6 項核心能力影音課程',
                note: '每月至少需參加 2 次內科部各次專科的總醫師教學。'
            },
            {
                level: 'PGY2 (內科組)',
                core: ['胸痛', '腹痛', '呼吸困難', '意識障礙', '發燒', '頭痛', '以及其他所有 10 項核心能力'],
                basic: ['全數基本疾病課程'],
                imaging: ['EKG', 'CXR', '進階影像'],
                video_req: '需完成所有 10 項核心能力影音課程',
                note: '每月至少需參加 4 次內科部各次專科的總醫師教學。'
            }
        ];

        const checklistData = {
            'PGY2醫師': [
                { item: '晨間病例討論或實證醫學報告', count: 1, unit: '次', type: 'presentation' },
                { item: '全人照護教育紀錄單', count: 4, unit: '份', type: 'record' },
                { item: '教學門診紀錄單', count: 2, unit: '份', type: 'record' },
                { item: 'Mini-CEX', count: 2, unit: '份', type: 'eval' },
                { item: '學習熱忱全方位(360度)評量表', count: 3, unit: '份', type: 'eval' },
                { item: 'EPA、Milestone', count: 1, unit: '份', type: 'eval' },
                { item: '病歷回顧口頭測驗評估表 (CbD)', count: 1, unit: '份 (每三個月)', type: 'exam' },
                { item: 'OSCE 測驗', count: 1, unit: '次', type: 'exam' }
            ],
            'PGY1醫師': [
                { item: '晨間病例討論或實證醫學報告', count: 1, unit: '次', type: 'presentation' },
                { item: '全人照護教育紀錄單', count: 4, unit: '份', type: 'record' },
                { item: '教學門診紀錄單', count: 2, unit: '份', type: 'record' },
                { item: 'Mini-CEX', count: 2, unit: '份', type: 'eval' },
                { item: '學習熱忱全方位(360度)評量表', count: 3, unit: '份', type: 'eval' },
                { item: 'EPA、Milestone', count: 1, unit: '份', type: 'eval' },
                { item: '病歷回顧口頭測驗評估表 (CbD)', count: 1, unit: '份 (每三個月)', type: 'exam' },
                { item: 'OSCE 測驗', count: 1, unit: '次', type: 'exam' }
            ],
            '外訓牙、中醫住院醫師': [
                { item: '晨會病例討論會報告', count: 1, unit: '次', type: 'presentation' },
                { item: '全人照護教育紀錄單', count: 4, unit: '份', type: 'record' },
                { item: '教學門診紀錄單', count: 2, unit: '份', type: 'record' },
                { item: 'Mini-CEX', count: 2, unit: '份', type: 'eval' },
                { item: '學習熱忱全方位(360度)評量表', count: 3, unit: '份', type: 'eval' }
            ],
            '實習醫學生': [
                { item: '晨會病例討論會報告', count: 1, unit: '次', type: 'presentation' },
                { item: '全人照護教育紀錄單', count: 2, unit: '份', type: 'record' },
                { item: '教學門診紀錄單', count: 1, unit: '份', type: 'record' },
                { item: 'Mini-CEX', count: 1, unit: '份', type: 'eval' },
                { item: '學習熱忱全方位(360度)評量表', count: 2, unit: '份', type: 'eval' }
            ]
        };

        const milestones = [
            { level: 1, title: '旁觀協助', desc: '教師在旁逐步共同操作。', note: '基礎養成期' },
            { level: 2, title: '共同操作', desc: '教師在旁，必要時提供協助。', note: '獨立發展期' },
            { level: 3, title: '事後確認', desc: '學員先執行，必要時尋求支援，教師事後確認。', target: 'PGY1 目標' },
            { level: 4, title: '必要支援', desc: '學員主導，僅在教師事後重點確認。', target: 'PGY2 (不分組) 目標' },
            { level: 5, title: '獨立執行', desc: '無需教師在場，可獨立完成。', target: 'PGY2 (內科組) 目標' }
        ];

        // --- Components ---

        const CompetencyModal = ({ data, onClose }) => {
            if (!data) return null;
            return (
                <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 animate-fade-in backdrop-blur-sm">
                    <div className="bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl animate-fade-in-up flex flex-col">
                        <div className="p-6 border-b border-gray-100 flex justify-between items-center bg-blue-50 sticky top-0 z-10">
                            <div className="flex items-center gap-3">
                                {data.icon}
                                <h2 className="text-2xl font-bold text-gray-800">{data.title}</h2>
                            </div>
                            <button onClick={onClose} className="p-2 hover:bg-gray-200 rounded-full transition text-gray-500">
                                <Icons.X size={24} />
                            </button>
                        </div>
                        <div className="p-6 space-y-6 overflow-y-auto">
                            <section>
                                <h3 className="text-lg font-semibold text-blue-600 mb-2 flex items-center gap-2">
                                    <Icons.BookOpen size={20} /> 核心定義與目標
                                </h3>
                                <p className="text-gray-700 leading-relaxed bg-blue-50/50 p-4 rounded-lg border border-blue-100">
                                    {data.what}
                                </p>
                            </section>
                            
                            <div className="grid md:grid-cols-2 gap-6">
                                <section className="bg-green-50 p-4 rounded-lg border border-green-100">
                                    <h3 className="text-lg font-semibold text-green-700 mb-3 flex items-center gap-2">
                                        <Icons.Activity size={20} /> 學習方式
                                    </h3>
                                    <ul className="space-y-2">
                                        {data.methods.map((m, i) => (
                                            <li key={i} className="flex items-start gap-2 text-gray-700">
                                                <span className="mt-1.5 w-1.5 h-1.5 bg-green-500 rounded-full shrink-0"></span>
                                                <span>{m}</span>
                                            </li>
                                        ))}
                                    </ul>
                                </section>
                                
                                <section className="bg-orange-50 p-4 rounded-lg border border-orange-100">
                                    <h3 className="text-lg font-semibold text-orange-700 mb-3 flex items-center gap-2">
                                        <Icons.ClipboardCheck size={20} /> 評估方式
                                    </h3>
                                    <ul className="space-y-2">
                                        {data.assessments.map((a, i) => (
                                            <li key={i} className="flex items-start gap-2 text-gray-700">
                                                <span className="mt-1.5 w-1.5 h-1.5 bg-orange-500 rounded-full shrink-0"></span>
                                                <span>{a}</span>
                                            </li>
                                        ))}
                                    </ul>
                                </section>
                            </div>
                        </div>
                        <div className="p-4 border-t border-gray-100 bg-gray-50 rounded-b-xl flex justify-end">
                            <button 
                                onClick={onClose}
                                className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium shadow-sm"
                            >
                                關閉視窗
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const CompetencyGrid = ({ onSelect }) => (
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                {competencies.map((c) => (
                    <div 
                        key={c.id} 
                        onClick={() => onSelect(c)}
                        className="bg-white rounded-xl p-6 shadow-sm hover:shadow-lg hover:-translate-y-1 transition-all duration-300 cursor-pointer border border-gray-100 group relative overflow-hidden h-full"
                    >
                        <div className="absolute top-0 left-0 w-1 h-full bg-blue-500 group-hover:w-2 transition-all"></div>
                        <div className="mb-4 transform group-hover:scale-110 transition-transform duration-300 origin-left">
                            {c.icon}
                        </div>
                        <h3 className="text-xl font-bold text-gray-800 mb-2 group-hover:text-blue-700 transition-colors">{c.title}</h3>
                        <p className="text-gray-600 text-sm line-clamp-2 mb-4">{c.desc}</p>
                        <div className="flex items-center text-blue-600 text-sm font-medium opacity-80 group-hover:opacity-100 transition-opacity mt-auto">
                            查看詳細內容 <Icons.ChevronRight size={16} className="ml-1 group-hover:translate-x-1 transition-transform" />
                        </div>
                    </div>
                ))}
            </div>
        );

        const RequirementsView = () => (
            <div className="space-y-8">
                {/* Title Card */}
                <div className="bg-gradient-to-r from-blue-600 to-cyan-600 rounded-xl p-8 text-white shadow-lg relative overflow-hidden">
                    <div className="relative z-10">
                        <h2 className="text-3xl font-bold mb-2 flex items-center gap-3">
                            <Icons.GraduationCap size={32} />
                            PGY 內科訓練課程要求
                        </h2>
                        <p className="opacity-90 text-blue-50">包含基本疾病、核心能力影音課程及影像教學要求</p>
                    </div>
                    <div className="absolute right-0 top-0 h-full w-1/3 bg-white/10 transform skew-x-12 pointer-events-none"></div>
                </div>

                {/* Requirements Cards */}
                <div className="grid md:grid-cols-3 gap-6">
                    {requirements.map((req, idx) => (
                        <div key={idx} className="bg-white rounded-xl shadow-md overflow-hidden border border-gray-100 flex flex-col hover:shadow-lg transition-shadow duration-300">
                            <div className={`p-4 font-bold text-lg text-center text-white shadow-sm ${
                                idx === 0 ? 'bg-teal-500' : idx === 1 ? 'bg-blue-500' : 'bg-purple-600'
                            }`}>
                                {req.level}
                            </div>
                            <div className="p-6 flex-1 flex flex-col space-y-5">
                                <div>
                                    <h4 className="font-bold text-gray-700 mb-3 flex items-center gap-2 text-sm uppercase tracking-wider border-b border-gray-100 pb-1">
                                        <Icons.Activity size={16} className="text-red-500"/> 核心症狀能力
                                    </h4>
                                    <div className="flex flex-wrap gap-2">
                                        {req.core.map((item, i) => (
                                            <span key={i} className="px-2.5 py-1 bg-red-50 text-red-700 text-sm rounded-full border border-red-100 font-medium">
                                                {item}
                                            </span>
                                        ))}
                                    </div>
                                </div>
                                
                                <div>
                                    <h4 className="font-bold text-gray-700 mb-3 flex items-center gap-2 text-sm uppercase tracking-wider border-b border-gray-100 pb-1">
                                        <Icons.BookOpen size={16} className="text-blue-500"/> 基本疾病課程
                                    </h4>
                                    <div className="flex flex-wrap gap-2">
                                        {req.basic.map((item, i) => (
                                            <span key={i} className="px-2.5 py-1 bg-blue-50 text-blue-700 text-sm rounded-full border border-blue-100 font-medium">
                                                {item}
                                            </span>
                                        ))}
                                    </div>
                                </div>

                                <div>
                                    <h4 className="font-bold text-gray-700 mb-3 flex items-center gap-2 text-sm uppercase tracking-wider border-b border-gray-100 pb-1">
                                        <Icons.Layout size={16} className="text-gray-500"/> 影像與影音
                                    </h4>
                                    <div className="space-y-2">
                                        <div className="flex flex-wrap gap-2">
                                            {req.imaging.map((item, i) => (
                                            <span key={i} className="px-2.5 py-1 bg-gray-100 text-gray-700 text-sm rounded-full border border-gray-200 font-medium">
                                                {item}
                                            </span>
                                            ))}
                                        </div>
                                        <div className="text-xs text-gray-500 bg-gray-50 p-2 rounded border border-gray-100">
                                            {req.video_req}
                                        </div>
                                    </div>
                                </div>

                                <div className="mt-auto pt-4 border-t border-gray-100 bg-yellow-50/50 -mx-6 px-6 pb-0">
                                    <p className="text-xs text-yellow-800 italic flex gap-2 py-3">
                                        <Icons.Info size={14} className="shrink-0 mt-0.5"/> {req.note}
                                    </p>
                                </div>
                            </div>
                        </div>
                    ))}
                </div>

                {/* Milestones Visualization */}
                <div className="bg-white rounded-xl shadow-md p-8 border border-gray-100">
                    <div className="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4">
                        <div>
                            <h3 className="text-2xl font-bold text-gray-800 flex items-center gap-2">
                                <Icons.TrendingUp className="text-blue-600" /> 臨床能力信賴等級 (EPAs) 里程碑
                            </h3>
                            <p className="text-gray-500 text-sm mt-1">從新手到專家的成長路徑</p>
                        </div>
                        <div className="flex gap-4 text-sm">
                            <div className="flex items-center gap-1"><span className="w-3 h-3 rounded-full bg-gray-200"></span> 基礎</div>
                            <div className="flex items-center gap-1"><span className="w-3 h-3 rounded-full bg-blue-200"></span> 進階</div>
                            <div className="flex items-center gap-1"><span className="w-3 h-3 rounded-full bg-blue-500"></span> 專家</div>
                        </div>
                    </div>
                    
                    <div className="relative py-4">
                        {/* Timeline Line Background */}
                        <div className="absolute top-10 left-0 w-full h-2 bg-gray-100 rounded-full hidden md:block"></div>
                        <div className="absolute top-10 left-0 w-3/5 h-2 bg-gradient-to-r from-gray-300 via-blue-300 to-blue-500 rounded-full hidden md:block opacity-30"></div>
                        
                        <div className="grid grid-cols-1 md:grid-cols-5 gap-8 relative">
                            {milestones.map((m, i) => (
                                <div key={i} className="relative flex flex-col items-center text-center group">
                                    {/* Node */}
                                    <div className={`w-20 h-20 rounded-full flex flex-col items-center justify-center border-4 z-10 bg-white transition-all duration-300 shadow-sm group-hover:shadow-lg group-hover:scale-110
                                        ${m.target 
                                            ? i === 4 ? 'border-blue-600 text-blue-700' : 'border-blue-400 text-blue-600' 
                                            : 'border-gray-300 text-gray-400'}
                                    `}>
                                        <span className="text-xs font-bold uppercase text-gray-400 mb-0.5">Level</span>
                                        <span className="text-2xl font-bold leading-none">{m.level}</span>
                                    </div>
                                    
                                    {/* Content */}
                                    <div className="mt-6 bg-gray-50 p-4 rounded-lg border border-gray-100 w-full min-h-[120px] flex flex-col justify-between group-hover:border-blue-200 transition-colors">
                                        <div>
                                            <h4 className={`font-bold text-lg mb-1 ${m.target ? 'text-blue-800' : 'text-gray-700'}`}>
                                                {m.title}
                                            </h4>
                                            <p className="text-xs text-gray-500 leading-relaxed">{m.desc}</p>
                                        </div>
                                        
                                        {m.target && (
                                            <div className="mt-3 pt-2 border-t border-gray-200">
                                                <span className={`inline-block px-2 py-0.5 text-[10px] rounded-full font-bold uppercase tracking-wide
                                                    ${i === 4 ? 'bg-blue-600 text-white' : 'bg-blue-100 text-blue-700'}`}>
                                                    {m.target}
                                                </span>
                                            </div>
                                        )}
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            </div>
        );

        const ChecklistView = () => {
            const [activeTab, setActiveTab] = useState('PGY2醫師');
            
            // Helper to get icon based on item type
            const getTypeIcon = (type) => {
                switch(type) {
                    case 'presentation': return <Icons.MessageCircle size={20} className="text-purple-500" />;
                    case 'record': return <Icons.FileText size={20} className="text-blue-500" />;
                    case 'eval': return <Icons.Target size={20} className="text-green-500" />;
                    case 'exam': return <Icons.Award size={20} className="text-orange-500" />;
                    default: return <Icons.List size={20} className="text-gray-400" />;
                }
            };

            return (
                <div className="bg-white rounded-xl shadow-lg overflow-hidden flex flex-col">
                    {/* 職級選擇 Tabs */}
                    <div className="bg-gray-50 border-b border-gray-200 p-2 flex flex-wrap gap-2 justify-center md:justify-start sticky top-0 z-10">
                        {Object.keys(checklistData).map(tab => (
                            <button
                                key={tab}
                                onClick={() => setActiveTab(tab)}
                                className={`px-6 py-3 rounded-lg text-sm font-bold transition-all flex-1 md:flex-none text-center ${
                                    activeTab === tab 
                                        ? 'bg-white text-blue-600 shadow-sm border-t-2 border-blue-600 ring-1 ring-black/5' 
                                        : 'text-gray-500 hover:bg-gray-200 hover:text-gray-700'
                                }`}
                            >
                                {tab}
                            </button>
                        ))}
                    </div>
                    
                    <div className="p-6 md:p-8 flex-1 bg-white animate-fade-in">
                        <div className="mb-8 flex flex-col md:flex-row md:items-center justify-between gap-4 pb-6 border-b border-gray-100">
                            <div>
                                <h3 className="text-2xl font-bold text-gray-800 flex items-center gap-3">
                                    <Icons.ClipboardCheck className="text-blue-600" size={28} /> 
                                    完訓標準清單
                                </h3>
                                <p className="text-gray-500 text-sm mt-1 ml-10">
                                    <span className="font-bold text-blue-800">{activeTab}</span> 於訓練期間內必須完成的項目統計
                                </p>
                            </div>
                            <div className="flex items-center gap-2 text-sm bg-blue-50 text-blue-700 px-4 py-2 rounded-lg font-medium self-start md:self-auto border border-blue-100">
                                <Icons.Target size={16} />
                                需完成總數: {checklistData[activeTab].length} 項
                            </div>
                        </div>

                        {/* 卡片式清單 (無 Checkbox) */}
                        <div className="grid gap-4 md:grid-cols-2">
                            {checklistData[activeTab].map((item, idx) => (
                                <div key={idx} className="flex items-center p-5 bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow group">
                                    {/* Icon Container */}
                                    <div className="h-12 w-12 rounded-xl bg-gray-50 flex items-center justify-center mr-4 group-hover:bg-blue-50 transition-colors">
                                        {getTypeIcon(item.type)}
                                    </div>
                                    
                                    {/* Text Content */}
                                    <div className="flex-1">
                                        <h4 className="font-bold text-gray-800 text-base mb-1">{item.item}</h4>
                                        <div className="text-xs text-gray-400 bg-gray-50 inline-block px-2 py-0.5 rounded border border-gray-100">
                                            {item.type === 'presentation' && '口頭報告'}
                                            {item.type === 'record' && '書面紀錄'}
                                            {item.type === 'eval' && '評量表'}
                                            {item.type === 'exam' && '測驗'}
                                        </div>
                                    </div>

                                    {/* Count */}
                                    <div className="text-right pl-4 border-l border-gray-100 ml-2 min-w-[80px]">
                                        <span className="block text-2xl font-extrabold text-blue-600">{item.count}</span>
                                        <span className="text-xs text-gray-500 font-medium">{item.unit}</span>
                                    </div>
                                </div>
                            ))}
                        </div>
                        
                        {/* 底部說明 */}
                        <div className="mt-8 p-4 bg-orange-50 border border-orange-100 rounded-lg flex gap-3 text-sm text-orange-800 items-start">
                            <Icons.Award className="shrink-0 mt-0.5 text-orange-600" size={20}/>
                            <div className="space-y-1">
                                <p className="font-bold">平台提示：</p>
                                <p className="opacity-90 leading-relaxed">
                                    本頁面僅供資訊查詢，請勿在此進行操作。
                                    所有實際紀錄單、評量表請務必登錄於<span className="font-bold underline">電子歷程系統</span>。
                                    部分項目（如 OSCE）將由教學部統一安排時間，請留意相關公告。
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [selectedCompetency, setSelectedCompetency] = useState(null);
            const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);

            // 捲動功能
            const scrollToSection = (id) => {
                const element = document.getElementById(id);
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
                setIsMobileMenuOpen(false);
            };

            const NavItem = ({ id, label, icon: Icon }) => (
                <button
                    onClick={() => scrollToSection(id)}
                    className="w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all font-medium text-gray-600 hover:bg-blue-50 hover:text-blue-600 text-left"
                >
                    <Icon size={20} />
                    <span>{label}</span>
                </button>
            );

            return (
                <div className="min-h-screen bg-gray-100 text-gray-800 font-sans flex flex-col md:flex-row selection:bg-blue-200 selection:text-blue-900">
                    
                    {/* Mobile Header */}
                    <div className="md:hidden bg-white p-4 shadow-sm flex justify-between items-center sticky top-0 z-20 border-b border-gray-200">
                        <div className="font-bold text-lg text-blue-900 flex items-center gap-2">
                            <div className="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold shadow-sm">奇</div>
                            內科訓練手冊
                        </div>
                        <button 
                            onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}
                            className="p-2 text-gray-600 hover:bg-gray-100 rounded-lg active:scale-95 transition-transform"
                        >
                            {isMobileMenuOpen ? <Icons.X /> : <Icons.Menu />}
                        </button>
                    </div>

                    {/* Sidebar Navigation */}
                    <aside className={`
                        fixed inset-y-0 left-0 z-30 w-72 bg-white border-r border-gray-200 transform transition-transform duration-300 ease-in-out shadow-xl md:shadow-none md:translate-x-0 md:sticky md:top-0 md:h-screen flex flex-col
                        ${isMobileMenuOpen ? 'translate-x-0' : '-translate-x-full'}
                    `}>
                        <div className="p-6 border-b border-gray-100 flex-shrink-0">
                            <div className="font-bold text-2xl text-blue-900 flex items-center gap-3 mb-2">
                                <div className="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-700 rounded-xl flex items-center justify-center text-white font-bold text-xl shadow-lg">奇</div>
                                一般醫學內科
                            </div>
                            <div className="text-xs font-medium text-gray-500 pl-[3.25rem] uppercase tracking-wider">核心能力導向訓練</div>
                        </div>
                        
                        <nav className="p-4 space-y-2 flex-1 overflow-y-auto scrollbar-hide">
                            <div className="text-xs font-bold text-gray-400 uppercase tracking-wider mb-2 px-4 mt-4">訓練指引導覽</div>
                            <NavItem id="overview" label="六大核心能力" icon={Icons.Layout} />
                            <NavItem id="requirements" label="分級訓練與里程碑" icon={Icons.GraduationCap} />
                            <NavItem id="checklist" label="完訓標準清單" icon={Icons.ClipboardCheck} />
                        </nav>

                        <div className="p-4 border-t border-gray-100 bg-gray-50/50 flex-shrink-0">
                            <div className="bg-blue-50 rounded-lg p-3 flex items-start gap-3">
                                <div className="bg-blue-100 p-1.5 rounded text-blue-600 shrink-0">
                                    <Icons.FileText size={16} />
                                </div>
                                <div className="text-xs text-blue-800">
                                    <p className="font-bold mb-0.5">資料來源</p>
                                    <p className="opacity-75 leading-tight">奇美醫學中心一般醫學內科訓練示範中心</p>
                                </div>
                            </div>
                        </div>
                    </aside>

                    {/* Main Content - Single Scrollable Page */}
                    <main className="flex-1 overflow-y-auto h-full min-h-screen p-4 md:p-8 lg:p-12 scroll-smooth">
                        <header className="mb-12 animate-fade-in">
                            <h1 className="text-4xl font-extrabold text-gray-900 tracking-tight mb-3">
                                一般醫學內科核心能力導向訓練指南
                            </h1>
                            <p className="text-lg text-gray-500 max-w-3xl leading-relaxed">
                                整合 ACGME 六大核心能力、PGY 分級訓練課程與里程碑，以及各職級完訓標準清單。請向下捲動或使用左側選單快速導覽。
                            </p>
                        </header>

                        <div className="space-y-20 pb-20 animate-fade-in-up">
                            
                            {/* Section 1: 核心能力 */}
                            <section id="overview" className="scroll-mt-20">
                                <div className="flex items-center gap-3 mb-6 pb-2 border-b border-gray-200">
                                    <Icons.Layout className="text-blue-600" size={28} />
                                    <h2 className="text-2xl font-bold text-gray-800">六大臨床核心能力 (ACGME)</h2>
                                </div>
                                <CompetencyGrid onSelect={setSelectedCompetency} />
                            </section>

                            {/* Section 2: 訓練課程與里程碑 */}
                            <section id="requirements" className="scroll-mt-20">
                                <div className="flex items-center gap-3 mb-6 pb-2 border-b border-gray-200">
                                    <Icons.GraduationCap className="text-blue-600" size={28} />
                                    <h2 className="text-2xl font-bold text-gray-800">PGY 分級訓練課程與里程碑</h2>
                                </div>
                                <RequirementsView />
                            </section>

                            {/* Section 3: 完訓清單 */}
                            <section id="checklist" className="scroll-mt-20">
                                <div className="flex items-center gap-3 mb-6 pb-2 border-b border-gray-200">
                                    <Icons.ClipboardCheck className="text-blue-600" size={28} />
                                    <h2 className="text-2xl font-bold text-gray-800">完訓標準清單</h2>
                                </div>
                                <ChecklistView />
                            </section>

                        </div>
                    </main>

                    {/* Modal for Competency Details */}
                    {selectedCompetency && (
                        <CompetencyModal 
                            data={selectedCompetency} 
                            onClose={() => setSelectedCompetency(null)} 
                        />
                    )}
                    
                    {/* Overlay for mobile menu */}
                    {isMobileMenuOpen && (
                        <div 
                            className="fixed inset-0 bg-black/30 z-20 md:hidden backdrop-blur-sm transition-opacity"
                            onClick={() => setIsMobileMenuOpen(false)}
                        ></div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
